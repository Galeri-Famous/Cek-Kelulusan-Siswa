<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cek Kelulusan Siswa Madrasah</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .fade-in {
      opacity: 0;
      animation: fadeIn 2s ease-in-out forwards;
    }
    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- Modal Notifikasi Sambutan -->
<div id="welcomeModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-xl shadow-lg max-w-lg w-full p-6 relative">
    <img src="https://img.icons8.com/fluency/96/graduation-cap.png" alt="Toga Kelulusan" class="mx-auto mb-4" />
    <h2 class="text-xl font-bold text-center mb-2">Selamat Datang</h2>
    <p class="text-gray-700 text-justify mb-4">
      Selamat datang di website cek kelulusan <strong>MI Asy-Syafi'iyyah 02 Jatibarang</strong>. 
      Silahkan cek status kelulusan anda dengan memasukkan <strong>Nama Lengkap</strong> atau <strong>Nomor NISN</strong> 
      anda pada kolom pencarian untuk melihat status kelulusan siswa.
      Kami ucapkan selamat untuk para siswa yang telah dinyatakan <strong>Lulus</strong> dari MI Asy-Syafi'iyyah 02 Jatibarang!
    </p>
    <p class="text-sm text-gray-500 text-center italic mb-4">
      Website ini merupakan website cek kelulusan pertama milik MI Asy-Syafi'iyyah 02 Jatibarang 
      yang dikelola oleh <strong>Media Misyada</strong> dan bekerjasama dengan <strong>Galeri Famous</strong> sebagai developernya.
    </p>
    <button onclick="closeModal()" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">Tutup</button>
  </div>
</div>

<script>
  function closeModal() {
    document.getElementById('welcomeModal').style.display = 'none';
  }

  <script>
    async function fetchData() {
      const sheetId = "12ECnsz-sA9iHH9jSyV-fSNXMsL6Sn-PTZJgg8gElcb0";
      const apiKey = "AIzaSyCWathz0NssmvXm0xBgm_ql7CpfU7Dg_dU";
      const range = "Sheet1!A2:D";

      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
      const response = await fetch(url);
      const data = await response.json();
      return data.values || [];
    }

    async function searchStudent() {
      const input = document.getElementById("searchInput").value.trim().toUpperCase();
      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "";

      const students = await fetchData();

      const found = students.find(row => {
        const name = row[0]?.toUpperCase();
        const nisn = row[3]?.toUpperCase();
        return input === name || input === nisn;
      });

      if (found) {
        const status = found[1];
        const sklLink = found[2];
        const boxColor = status === "LULUS" ? "bg-green-500" : "bg-red-500";
        const message = status === "LULUS" ? "Selamat Anda Dinyatakan LULUS" : "Maaf, Anda Belum Lulus";

        resultDiv.innerHTML = `
          <div class="text-center fade-in">
            <div class="${boxColor} text-white text-2xl font-bold py-4 px-6 rounded shadow mb-4">
              ${message}
            </div>
            ${sklLink ? `<a href="${sklLink}" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded" download>Download SKL</a>` : ""}
          </div>
        `;
      } else {
        resultDiv.innerHTML = `<p class="text-red-600 font-semibold fade-in">Data tidak ditemukan.</p>`;
      }
    }
  </script>
</body>
</html>
